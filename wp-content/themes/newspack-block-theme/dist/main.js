(()=>{"use strict";const e=e=>{"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",e):e())},t="menu-open--",n="overlay-contents--position--",o={OPACITY:125,POSITION:250,OVERLAY:500},r="-100%",i='button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]), iframe, object, embed, [contenteditable="true"]',c=new WeakMap,s=new WeakMap;let l,a=null;const u=e=>{if(!e)return[];const t=e.querySelectorAll(i);return Array.from(t).filter((e=>{try{const t=e.getBoundingClientRect(),n=window.getComputedStyle(e);return t.width>0&&t.height>0&&"hidden"!==n.visibility&&"none"!==n.display&&!e.hasAttribute("hidden")}catch(e){return!1}}))},d=(e,t)=>{Array.from(e.classList).filter((e=>e.startsWith(t))).forEach((t=>e.classList.remove(t)))},m=e=>e&&e.classList.contains(n+"full-width"),y=e=>document.querySelectorAll(`[class*=${e}]`),p=()=>document.body.className.includes(t),f=(()=>{let e=null,t=null,n=null;return{show:(t=o.OVERLAY)=>{const r=(()=>{if(e)return e;e=document.createElement("div"),e.className="overlay-mask",e.style.display="none",e.style.opacity="0";const t=e=>{"keydown"===e.type&&"Escape"!==e.key||p()&&v()};return e.addEventListener("click",t),document.addEventListener("keydown",t),n=t,document.body.appendChild(e),e})();r.style.transition=`opacity ${t}ms ease-in-out`,r.style.display="block",r.offsetHeight,requestAnimationFrame((()=>{r.style.opacity="1"}))},hide:(n=o.OVERLAY)=>{e&&(e.style.opacity="0",clearTimeout(t),t=setTimeout((()=>{e&&(e.style.display="none",e.remove(),e=null)}),n))},cleanup:()=>{n&&(document.removeEventListener("keydown",n),n=null),e&&(e.remove(),e=null)}}})(),h=(()=>{const e=new WeakMap,t=e=>{const t=[{direction:"left",property:"left",hiddenValue:r,visibleValue:"0"},{direction:"right",property:"right",hiddenValue:r,visibleValue:"0"},{direction:"full-width",property:"transform",hiddenValue:"translateY(-1rem)",visibleValue:"translateY(0)"}];for(const o of t)if(e.classList.contains(n+o.direction))return o;return null};return{slideIn:(n,r=o.OPACITY,i=o.POSITION)=>{if(!n||!n.style)return;const c=t(n);if(!c)return;const s=e.get(n);s&&s(),n.style.opacity="0",n.style[c.property]=c.hiddenValue,n.style.transition=`opacity ${r}ms ease-in-out, ${c.property} ${i}ms ease-in-out`,n.offsetHeight,requestAnimationFrame((()=>{n.style.opacity="1",n.style[c.property]=c.visibleValue})),e.set(n,(()=>{n.style.opacity="",n.style[c.property]="",n.style.transition="",e.delete(n)}))},slideOut:(n,r=o.OPACITY,i=o.POSITION,c=null)=>{if(!n||!n.style)return void(c&&c());const s=t(n);if(!s)return void(c&&c());n.style.transition=`opacity ${r}ms ease-in-out, ${s.property} ${i}ms ease-in-out`,n.style.opacity="0",n.style[s.property]=s.hiddenValue;const l=Math.max(r,i);setTimeout((()=>{const t=e.get(n);t&&t(),c&&c()}),l)},cleanup:()=>{e.forEach((e=>e()))}}})(),g=(()=>{let e=null;return{startMonitoring:()=>{e||(e=setInterval((()=>{if(!p()||!a)return;const e=a.ownerDocument.activeElement;if(!a.contains(e)&&e!==document.body&&e!==document.documentElement){const e=u(a)[0];e&&e.focus()}}),50))},stopMonitoring:()=>{e&&(clearInterval(e),e=null)}}})(),S=e=>{const t=s.get(e);t&&t();const n=e.querySelectorAll(i),o=n[0],r=n[n.length-1];if(!o||!r)return()=>{};const c=t=>{if("Tab"!==t.key)return;if(!p())return;const n=u(e),o=n[0],r=n[n.length-1];if(!o||!r)return void t.preventDefault();const i=e.ownerDocument.activeElement;if(!e.contains(i))return t.preventDefault(),void o.focus();t.shiftKey?i===o&&(t.preventDefault(),r.focus()):i===r&&(t.preventDefault(),o.focus())};document.addEventListener("keydown",c,!0),e.addEventListener("keydown",c);const l=()=>{document.removeEventListener("keydown",c,!0),e.removeEventListener("keydown",c),s.delete(e),a===e&&(a=null)};return s.set(e,l),a=e,g.startMonitoring(),l},v=()=>{g.stopMonitoring();const e=y(t),n=Array.from(y("__contents")).filter((e=>e.parentNode===document.body&&c.has(e)));if(e.forEach((e=>{m(e)||d(e,t)})),d(document.body,t),n.forEach((e=>{const n=s.get(e);n&&n();const r=c.get(e);if(!r)return;const i=m(e);h.slideOut(e,o.OPACITY,o.POSITION,(()=>{i&&d(e,t),((e,t)=>{if(e&&t)try{t.nextSibling&&document.contains(t.nextSibling)?t.parent.insertBefore(e,t.nextSibling):t.parent.appendChild(e)}catch(t){document.body.appendChild(e)}})(e,r),c.delete(e)}))})),l)try{document.contains(l)&&!l.disabled&&l.focus()}catch(e){}f.hide(o.OVERLAY)},b=e=>{if(!(e=>["menuType","containerSelector","toggleSelector","contentsSelector"].every((t=>e[t])))(e))return{init:()=>{}};const{menuType:n,containerSelector:r,toggleSelector:s,contentsSelector:a,overlayAnimationDuration:u=o.OVERLAY,onOpen:d=null,onClose:y=()=>{},specialHandling:p=()=>{}}=e,g=t+n;return{init:()=>{const e=document.body,t=document.querySelector(r),o=document.querySelectorAll(s),b=document.querySelector(a);if(!t||!o.length||!b)return;if(!1===p(t,o,b))return;const w=n=>{n.preventDefault(),e.classList.contains(g)?(v(),y(b,t,o)):_()},_=()=>{if(e.classList.add(g),b.classList.add(g),((e,t)=>{e&&!c.has(e)&&(c.set(e,{parent:e.parentNode,nextSibling:e.nextSibling}),document.body.appendChild(e),h.slideIn(e),((e,t="")=>{l=e.ownerDocument.activeElement;const n=e.querySelector(".newspack-icon-close"),o=e.querySelector("a.screen-reader-text");if(!n&&!o){const n="search-menu"===t?newspackScreenReaderText.close_search:newspackScreenReaderText.close_menu,o=document.createElement("a");o.href="#",o.className="screen-reader-text",o.textContent=n,o.addEventListener("click",(e=>{e.preventDefault(),v()})),e.insertBefore(o,e.firstChild)}S(e);const r=e.querySelector(i);r&&r.focus()})(e,t))})(b,n),m(b)||f.show(u),d)d(b,t,o);else{const e=((e,t)=>{if(!t)return null;const n=`.${e}__toggle a`;return t.querySelector(n)})(n,b);e&&e.focus()}};o.forEach((e=>{e.addEventListener("click",w,!1)}))}}};e((function(){b({menuType:"comments-menu",containerSelector:".comments-menu",toggleSelector:".comments-menu__toggle",contentsSelector:".comments-menu__contents",onOpen:e=>{setTimeout((()=>{S(e)}),100)}}).init()})),e((function(){b({menuType:"drawer-menu",containerSelector:".drawer-menu",toggleSelector:".drawer-menu__toggle",contentsSelector:".drawer-menu__contents"}).init()})),e((function(){b({menuType:"mobile-menu",containerSelector:".header-mobile",toggleSelector:".mobile-menu__toggle",contentsSelector:".mobile-menu__contents"}).init()})),e((function(){b({menuType:"search-menu",containerSelector:".search-menu",toggleSelector:".search-menu__toggle",contentsSelector:".search-menu__contents",overlayAnimationDuration:250,onOpen:e=>{const t=e?.querySelector('input[type="search"]');t&&t.focus()},specialHandling:e=>{if(newspackScreenReaderText.jetpack_instant_search){const t=e.querySelector(".search-menu__toggle a");return t&&t.classList.add("jetpack-search-filter__link"),!1}}}).init()}))})();